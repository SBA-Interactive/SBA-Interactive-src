---
import "../styles/global.css";
import Header from "../components/header.svelte";
import Footer from "../components/footer.svelte";
import CookieConsent from "../components/CookieConsent.svelte";
import heroBg from '../assets/images/hero.webp';

const { 
  title = "SBA Interactive", 
  description = "Premium web development and digital architecture services specializing in high-performance WordPress and custom React solutions.",
  ogType = "website",
  ogPrice = "Contact"
} = Astro.props;

---
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title}</title>
    <script type="application/ld+json">
      {"@context":"https://schema.org","@type":"ProfessionalService","name":"SBA Interactive","url":"https://sba-interactive.github.io","logo":"https://sba-interactive.github.io/images/hero.webp","image":"https://sba-interactive.github.io/images/hero.webp","description":"Premium web development and digital architecture services specializing in high-performance WordPress and custom React solutions.","address":{"@type":"PostalAddress","streetAddress":"Mazowieckie Technikum Innowacji","addressLocality":"Plock","addressCountry":"PL"},"contactPoint":[{"@type":"ContactPoint","email":"hello@sbainteractive.com","contactType":"customer service","availableLanguage":["English","Polish","German","Spanish","French","Italian","Greek","Chinese"]},{"@type":"ContactPoint","email":"help@sbainteractive.com","contactType":"technical support"}],"sameAs":["https://github.com/SBA-Interactive"],"priceRange":"$$$"}
    </script>

    <meta name="description" content={description} />
    <meta name="robots" content="index, follow" />
    
    <meta name="keywords" content="web development, WordPress, custom React solutions, SaaS, Astro, Next.js, high-performance websites, SBA Interactive" />
    <meta name="author" content="SBA Interactive" />
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)" />
    <meta name="theme-color" content="#0f172a" media="(prefers-color-scheme: dark)" />

    <meta property="og:site_name" content="SBA Interactive" />
    <meta property="og:type" content={ogType} />
    <meta property="og:url" content={Astro.url} />
    <meta property="og:title" content={title === "SBA Interactive" ? "SBA Interactive - Elite Digital Engineering" : title} />
    <meta property="og:description" content={description} />
    <link rel="preload" as="image" href={heroBg.src} fetchpriority="high" />
    <meta property="og:image" content={heroBg.src} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="SBA Interactive - Elite Digital Engineering" />

    <!-- Twitter/X Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@SBAInteractive" />
    <meta name="twitter:creator" content="@SBAInteractive" />
    <meta name="twitter:title" content={title === "SBA Interactive" ? "SBA Interactive - Elite Digital Engineering" : title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={heroBg.src} />
    <meta name="twitter:image:alt" content="SBA Interactive Banner" />

    <!-- Pinterest Rich Pins -->
    <meta property="og:rich_attachment" content="true" />
    <meta name="pinterest-rich-pin" content="true" />
    {ogType === 'product' ? (
      <>
        <meta property="product:price:amount" content={ogPrice} />
        <meta property="product:price:currency" content="USD" />
        <meta property="product:availability" content="in stock" />
        <meta property="product:condition" content="new" />
        <meta property="product:retailer_item_id" content="sba-web-services" />
      </>
    ) : (
      <>
        <meta property="article:author" content="SBA Interactive" />
        <meta property="article:publisher" content="SBA Interactive" />
      </>
    )}
    <link rel="alternate" hreflang="en" href="https://sba-interactive.github.io/sba-interactive?lang=en" />
    <link rel="alternate" hreflang="de" href="https://sba-interactive.github.io/sba-interactive?lang=de" />
    <link rel="alternate" hreflang="es" href="https://sba-interactive.github.io/sba-interactive?lang=es" />
    <link rel="alternate" hreflang="tr" href="https://sba-interactive.github.io/sba-interactive?lang=tr" />
    <link rel="alternate" hreflang="uk" href="https://sba-interactive.github.io/sba-interactive?lang=uk" />
    <link rel="alternate" hreflang="ja" href="https://sba-interactive.github.io/sba-interactive?lang=ja" />
    <link rel="alternate" hreflang="fr" href="https://sba-interactive.github.io/sba-interactive?lang=fr" />
    <link rel="alternate" hreflang="it" href="https://sba-interactive.github.io/sba-interactive?lang=it" />
    <link rel="alternate" hreflang="pl" href="https://sba-interactive.github.io/sba-interactive?lang=pl" />
    <link rel="alternate" hreflang="el" href="https://sba-interactive.github.io/sba-interactive?lang=el" />
    <link rel="alternate" hreflang="zh-hans" href="https://sba-interactive.github.io/sba-interactive?lang=zh-hans" />
    <link rel="alternate" hreflang="zh-yue" href="https://sba-interactive.github.io/sba-interactive?lang=zh-yue" />
    <link rel="alternate" hreflang="zh" href="https://sba-interactive.github.io/sba-interactive?lang=zh" />
    <link rel="alternate" hreflang="x-default" href="https://sba-interactive.github.io/sba-interactive?lang=en" />

    <!-- Base Consent Mode -->
    <script is:inline>
      window.dataLayer = window.dataLayer || [];
      window.gtag = window.gtag || function(){dataLayer.push(arguments);};
      
      const storedConsent = localStorage.getItem('cookie-consent');
      if (storedConsent) {
        const prefs = JSON.parse(storedConsent);
        gtag('consent', 'default', {
          'ad_storage': prefs.marketing ? 'granted' : 'denied',
          'ad_user_data': prefs.marketing ? 'granted' : 'denied',
          'ad_personalization': prefs.marketing ? 'granted' : 'denied',
          'analytics_storage': prefs.analytics ? 'granted' : 'denied'
        });
      } else {
        gtag('consent', 'default', {
          'ad_storage': 'denied',
          'ad_user_data': 'denied',
          'ad_personalization': 'denied',
          'analytics_storage': 'denied',
          'wait_for_update': 500
        });
      }
    </script>

    <!-- Google Tag Manager -->
    <script is:inline>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;
    j.type = 'text/partytown';
    f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-58VDBLT8');
    </script>
    <!-- End Google Tag Manager -->
    <!-- Google Tag (gtag.js) -->
    <script type="text/partytown" async src="https://www.googletagmanager.com/gtag/js?id=G-HL7XPCF8EJ"></script>
    <script is:inline>gtag('js', new Date()); gtag('config', 'G-HL7XPCF8EJ');</script>
    <meta name="google-site-verification" content="rmWHg9Fjfw_SjUJ77HLOw8mNXZRjyNHpmZvWViNUjME" />
    <!-- End Google Tag (gtag.js) -->

    <link rel="canonical" href={Astro.url} />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <link rel="apple-touch-icon" sizes="180x180" href="images/hero.webp" />
    <link rel="sitemap" href="/sitemap-index.xml" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap" rel="stylesheet">

    <script>
      (() => {
        const params = new URLSearchParams(window.location.search);
        const doc = document.documentElement;

        const urlTheme = params.get('theme');
        const theme = urlTheme || localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        
        if (urlTheme) localStorage.setItem('theme', urlTheme);
        doc.classList.toggle('dark', theme === 'dark');

        const supportedLangs = ['en', 'pl', 'de', 'es', 'fr', 'it', 'gr', 'zh', 'yue', 'tr', 'uk', 'ja'];
        const urlLang = params.get('lang')?.toLowerCase();
        const storedLang = localStorage.getItem('sba_lang');

        let finalLang = storedLang || 'en';

        if (urlLang && supportedLangs.includes(urlLang)) {
          finalLang = urlLang;
          localStorage.setItem('sba_lang', urlLang);
        } else if (!storedLang) {
          const browserLang = navigator.language.split('-')[0];
          if (supportedLangs.includes(browserLang)) finalLang = browserLang;
          localStorage.setItem('sba_lang', finalLang);
        }

        doc.lang = finalLang;
      })();
    </script>

    <meta name="generator" content={Astro.generator} />
  </head>
  <body class="min-h-screen flex flex-col">
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-58VDBLT8"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    <Header client:load />
    <main class="flex-grow"><slot /></main>
    <div class="sr-only" aria-hidden="true">creative agency marketing seo building websites specialized wordpress custom react digital solutions</div>
    <Footer client:visible />
    <CookieConsent client:load />
  </body>
</html>
